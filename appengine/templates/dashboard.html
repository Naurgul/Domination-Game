{% extends "base_group.html" %}

{% block content %}
<h1>{{user.current_team.name}} <small>Dashboard</small></h1>

<div class='row'>
	<div class='span10'>
		<p>Welcome to your dashboard. Here you and your teammembers can choose which of your uploaded brains are 
			active in the competition ladder. You can also upload new brains here. Note that you are only allowed
			to upload <strong>{{group.max_uploads}} brains</strong> in every 7 day period, 
			you have uploaded <strong>{{user.current_team.recent_upload_count}}</strong>.
		</p>
		<p>Note also that all code you upload here will be open sourced after a period of {{group.release_delay.days}} days.</p>
	</div>
	<div class='span6'>
	<h4>Members</h4>
	<ul class='unstyled'>
		{% for member in user.current_team.members %}
			<li>{{member.nickname}} ({{member.key.name}})</li>
		{% endfor %}
	</ul>
	</div>
</div>

<ul class='tabs'>
  <li class="active"><a href="#select-active">Select active</a></li>
  <li><a href="#upload-new">Upload new</a></li>
</ul>	

<div>
	<div id='select-active'>
	<form method="post" action="" class='form-stacked flushleft'>
		<input id='activebrains' type='hidden' name='activebrains' value='{{user.current_team.activebrainkeyids|join:","}}'>
		<fieldset>
		<legend>Select active brains</legend>
		<div id='active-agent-select' class='row'>
		{% for letter in "ABC"|make_list %}
			<div class='span-one-third'>
				<label>Brain {{letter}}</label>
					{% for brain in user.current_team.allbrains %}
					<input type='radio' id="brain-{{letter}}-{{brain.key.id}}" name="brain-{{letter}}" value='{{brain.key.id}}'>
					<span><a href="{{brain.url}}">{{brain}}</a></span>
					<br/>
					{% endfor %}
			</div>
		{% endfor %}
		</div>
	
		<div class='actions'><input type='submit' class='btn primary' value='Save'></input></div>
		</fieldset>
	</form>

	<script type="text/javascript" charset="utf-8">
	var ids = $('activebrains').value.split(',');
	for (var i = 0; i < ids.length; i++){
		var l = "ABC"[i];
		var htmlid = 'brain-'+l+'-'+ids[i];
		console.log(htmlid)
		$(htmlid).set('checked', true);
	}
	</script>
	</div>

	<div id='upload-new'>
	<form class='form-stacked flushleft' method="post" action="">	
		<fieldset>
		<legend>Upload new brain</legend>
		<textarea id='newbrain' name='newbrain' rows='100' cols='80'># Paste your code.</textarea>
		<script type="text/javascript" charset="utf-8">
			var myCodeMirror = CodeMirror.fromTextArea(document.id('newbrain'), {'lineNumbers':true});
		</script>
		<div class='actions'><input type='submit' class='btn primary' value='Upload new brain'></input></div>
		</fieldset>
	</form>
	</div>
</div>


{% endblock content %}
